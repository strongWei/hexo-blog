---
title: JavaScript 基础篇 - 运算符
categories:
  - JavaScript
date: 2019-01-01 15:40:28
tags:
---

JavaScript说起来挺简单，但实际上又有它自己的独特的深度。如今JavaScript不仅仅能够在网页上独挡一面，还能够用运用到app的编写上，甚至在后端的领域也能有自己的独到之处。因此学习JavaScript变得越来越重要。而从今天开始，我将通过一个系列来总结一下自己的学习成果和实际经验。
 
### Knowledge  
> 这里的知识点主要是通过学习[JS教程](https://wangdoc.com/javascript)并结合过去自己零零碎碎的知识来总结一下自己忽略的知识点，并不是完整的知识点总结 
 
<!-- more -->

#### 分类
运算符主要分为算术运算符，比较运算符，逻辑运算符，位运算符，其它运算符。

#### 算术运算符
> 除了加法运算符，其它的运算符主要是进行数值运算，所有的运算子都会直接转换成数值，然后再进行运算

##### 加法运算符
运算规则
+ 原始值的相加（非字符串): 所有非数值的原始值都会自动转换为数值，再进行相加
+ 字符串的相加：`+` 将会重载为字符串的连接，执行连接操作
+ 对象的相加：对象会先转换成原始值，然后再进行相加

对象的原始值转换
+ 原理：对象会先执行 `valueOf()`, 如果返回的值不是原始值，则再使用原对象执行 `toString()`, 反之，不再执行其它操作
+ 特例：Date会直接执行 `toString()`

##### 余数
运算结果的正负值由第一个运算子决定。如果第二个运算子是浮点数，可能不会得出正确的结果，仅仅在刚好整除的情况下会得出正常值

##### 数值运算符`+`
作用是可以将任意值转换为数值

##### 指数运算符 `**`
运算规则是右结合 

#### 比较运算符

##### 非相等运算符 `>` `>=` `<` `<=` 
运算规则  
- 两个运算子都是字符串: 从左到右分别依次比较字符的`unicode`
- 至少有一个不是字符串:   
	- 如果两个都是原始值，则先转换成数值，再进行比较
	- 如果有一个是对象，则先将对象转换成原始值，再进行比较
	- `NaN` 与任意值的比较都是 `false`

##### 严格相等运算符 `===`
> 严格不相等是对严格相等进行取反

运算规则
1. 如果是不同类型的值，直接返回false
2. 如果是同一类的原始值，直接进行比较
3. 如果是复合类型值，是比较它们是不是指向同一个地址
4. `undefined` 和 `null` 与自身严格相等

##### 相等运算符 `==`
> 不相等是对相等进行取反 
运算规则
1. 如果是同一类型的值，规则与 `===` 完全一致
2. 如果都是原始值，都会直接转换成数值，再进行比较
3. 如果是对象与原始值，应该将对象转换成原始值之后再进行比较
4. `undefined` 和 `null` 与其它值比较时，都为 `false`, 两者的比较为true

#### 布尔运算符
布尔运算符包括取反运算符`!`，或运算符`||`，与运算符`&&`, 三元条件运算符`?:`。
##### 取反运算符 !
不管什么类型的值，经过取反后，都变成布尔值  
`!!x` 常用的类型转换写法，与`Boolean(x)` 一样

##### 或运算符 || 
特殊用法: 常用于为某个变量设置默认值

#### 位运算符
包括 或运算符`|`，与运算符`&`, 否运算符`~`, 异或运算符`^`, 左移运算符`<<`, 右运算符`>>`, 带符号位的右移运算符`>>>`

##### 运算规则
做位运算时，会先将运算子转换成32位带符号的整数，返回的结果也是一个32位带符号的整数。  

##### 获取负数对应的10进制值的方法
如果一个数的二进制符号位是1, 则它是一个负数，需要先将这个数减去1,再取一次反，然后加上负号，才能得到结果

##### 或运算符
特殊用法： 将一个任意数值转换成32位的整数 **[最常用]**
```js 
function toInt32(x){
	return x | 0;
}
```

##### 否运算符
快速求值方法: -1 减 原值  
特殊用法: 双否相当于取整 **[效率最高]**

##### 异或运算符
特殊用法: 交换值 `a^=b; b^=a; a^=b` **[效率最高]**  
取整: `x ^ 0`

##### 左移运算符
相当于将一个数乘以2的移动位数次方  
取整: `x << 0`  
例子: 将颜色的RGB值转为HEX
```js
var color = {r: 186, g:218, b:85};

var rgb2hex = function(r,g,b) {
	// 1 << 24 保证结果是6位数
	return '#' + (( 1 << 24 ) + (r << 16) + (g << 8) + b)
		.toString(16)  //转16进制数，再返回字符串
		.substr(1);  
};
rgb2hexo(color.r, color.g, color.b)
```
##### 右移运算符
相当于一个数除以2的移动位数次方

##### 带符号的右移运算符
对于正数来说，它与右移运算符的原理是完全一样的，对于负数，它主要用于查看一个负整数在计算机内部的储存形式。
```js
 -1 >>> 0
```

##### 应用：开关
```
var FLAG_A = 1;
var FLAG_B = 2;
var FLAG_C = 4;
var FLAG_D = 8;

var flags = 5;
//判断是否打开了某个开关
flags & FLAG_A

var mask = FLAG_A | FLAG_B | FLAG_D;  //假设需要打开3个开关

flags | mask //确保打开指定的开关
flags & mask //与开关不一样的项，全部关闭
flags ^ mask //切换开关
~flags       //翻转开关
```
 
### Exprience
#### `1+{}` `{}+1` `{}+{}`
```js
1+{} // '1[object Object]'

{}+1 // 1，javascript引擎会将{}当作一个块来处理，直接忽略掉

{}+{} // 根据转换规则，结果应该为NaN(Firefox,IE), 但是在
      // Chrome,Sarify,Node.js是 '[object Object][object Object]'
      // 结果不知道
```


